<div id="topPanel">
    <div id="logo"></div>
    <div class="user-panel">
        <div class="user-panel_handle-container">
            <button class="user-panel_menu-button">
                <span class="user-panel_handle-icon"><i class="fa fa-user"></i></span>
                <span>{{user.handle}}</span>
            </button>
            <div class="user-panel_menu">
                <div class="user-panel_menu_triangle"></div>
                <ul class="user-panel_menu_list">
                    <li class="user-panel_menu_item"><a href="#settings"><i class="fa fa-cog"></i>&nbsp; settings</a></li>
                    <li class="user-panel_menu_item"><a ng-click="logout()"><i class="fa fa-sign-out"></i>&nbsp; sign out</a></li>
                </ul>
            </div>
        </div>
    </div><!-- end #user-panel -->
</div><!-- end #topPanel -->

<div id="mainContainer">
    <!-- Group List -->
    <div id="leftCol">

        <div id="groupPanel">

            <div class="spinnerDiv" ng-if="groupsLoading"><i class="fa fa-spinner fa-pulse fa-2x"></i></div>
            <div ng-repeat="group in groups track by $index">
                <button class="groupButton" ng-click="selectGroup(group)" ng-class="{gb_selected: group==selected_group}">{{$index+1}}</button>
                <button class="groupRemoveButton" ng-click="removeGroup(group, $index)"><i class="fa fa-times fa-2x"></i></button>
            </div>
            <div id="groupAddButton" ng-click="addGroup()"><i class="fa fa-users fa-2x"></i><i class="fa fa-plus" style="position: relative; top: 4px; left: 2px;"></i></div>

        </div><!-- end #groupPanel -->

    </div><!-- end #leftCol -->
    
    <div id="centerCol">

        <div id="postForm">
            <article>
                
                <div id="showPostFormButton" ng-click="showPostForm()" ng-hide="postFormVisible">What's the word?</div>
                
                <form ng-submit="submitPost(selected_group, content)" ng-show="postFormVisible">
                    
                    <div id="postFormInput">
                        <div id="postFormTextBox" contenteditable ng-model="content"></div>
                    </div>
                    <div id="postFormAction">
                        <button type="submit">
                            <span class="icon"><i class="fa fa-pencil-square-o"></i></span>
                            <span class="text">Post</span>
                        </button>
                    </div>
                    
                </form>
                
            </article>
        </div><!-- #postForm -->
        
        <div class="alert" ng-if="posts.length==0 && !postsLoading"><i class="fa fa-exclamation-triangle"></i>&nbsp; No messages exist for this group.</div>
        
        <!-- Posts "Update Pending" Spinner -->
        <div class="spinnerDiv bottom-margin" ng-if="postsUpdatePending"><i class="fa fa-spinner fa-pulse fa-3x"></i></div>
        
        <div class="post" ng-repeat="post in posts track by $index">
            <aside class="postActions" ng-if="post.user_handle == user.handle">
                <button ng-click="showEditForm($index)" ng-if="!post.editMode"><i class="fa fa-pencil"></i></button>
                <button ng-click="editPost($index)" ng-if="post.editMode"><i class="fa fa-floppy-o"></i></button>
                <button ng-click="deletePost($index)"><i class="fa fa-trash"></i></button>
            </aside>
            <article>
                <h2 class="postName">{{post.user_handle}}</h2>
                <aside class="postDate">{{convertDate(post.date)}}</aside>
                <p ng-if="!post.editMode">{{post.content}}</p>
                
                <div class="editForm" ng-if="post.editMode">
                    <div class="editTextBox" contenteditable ng-model="post.editContent">{{post.content}}</div>
                </div>
            </article>
            <footer>
                <div class="comments" ng-if="post.commentsVisible">
                    
                    <!-- Comments "Show More" Spinner -->
                    <div class="spinnerDiv" ng-if="post.commentsLoading"><i class="fa fa-spinner fa-pulse fa-2x"></i></div>
                    
                    <!-- Show More -->
                    <button class="commentsShowMoreButton" ng-click="getComments($index)" ng-if="post.comments.length < post.comment_count && !post.commentsLoading">
                        <i class="fa fa-chevron-circle-up"></i> &nbsp; Show More
                    </button>
                    
                    <!-- Comment -->
                    <article ng-repeat="comment in post.comments">
                        <header>{{comment.user_handle}}</header>
                        <p>{{comment.content}}</p>
                        <aside>
                            <span>{{convertDate(comment.date)}}</span>
                            <span ng-if="comment.user_handle == user.handle">
                                <button class="comment_edit-button"><i class="fa fa-pencil"></i></button>
                                <button class="comment_edit-button"><i class="fa fa-floppy-o"></i></button>
                                <button class="comment_edit-button"><i class="fa fa-trash"></i></button>
                            </span>
                        </aside>
                    </article>
                    
                    <!-- Comments "Update Pending" Spinner -->
                    <div class="spinnerDiv top-margin" ng-if="post.commentsUpdatePending"><i class="fa fa-spinner fa-pulse fa-2x"></i></div>
                    
                </div>
                
                <!-- Comments Form -->
                <div class="commentsForm" ng-if="post.commentsVisible">
                    <div class="commentsTextBox" contenteditable ng-model="post.commentsFormContent"></div>
                    <button class="commentsSubmitButton" ng-click="submitComment($index)"><i class="fa fa-arrow-circle-right"></i></button>
                </div>
                
                <div class="postFooterActions">
                    
                    <!-- Show Comments Button -->
                    <button class="commentsButton" ng-click="showComments($index)" ng-if="!post.commentsVisible">
                        <span ng-if="post.comment_count > 0"><i class="fa fa-comments"></i>&nbsp;Comments [{{post.comment_count}}]</span>
                        <span ng-if="post.comment_count == 0"><i class="fa fa-comment"></i>&nbsp;Write a comment?</span>
                    </button>
                </div>
            </footer>
        </div>
        
        <!-- Posts "Show More" Spinner -->
        <div class="spinnerDiv" ng-if="posts.length < totalPosts && totalPosts != 0"><i class="fa fa-spinner fa-pulse fa-3x"></i></div>
        
        <div class="alert" ng-if="posts.length == totalPosts && posts.length > 0"><p><i class="fa fa-exclamation-triangle"></i>&nbsp; No more messages.</p></div>
        
    </div><!-- end #centerCol -->
    
    <!-- Member List -->
    <div id="rightCol">

        <div id="memberPanel">
            <ul>
                <li class="header"><i class="fa fa-users"></i>&nbsp;Users</li>
                <li ng-repeat="member in groupMembers"><i class="fa fa-user"></i>&nbsp; {{member.handle}}</li>
            </ul>
            <div class="spinnerDiv" ng-if="membersLoading"><i class="fa fa-spinner fa-pulse fa-2x"></i></div>
        </div><!-- end #memberPanel -->

    </div><!-- end #rightCol -->
</div><!-- end #container -->